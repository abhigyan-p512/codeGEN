{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\abhig\\\\OneDrive\\\\Desktop\\\\leetclone\\\\client\\\\src\\\\pages\\\\DuelRoomPage.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef } from \"react\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport { useAuth } from \"../context/AuthContext\";\nimport api from \"../utils/api\";\nimport duelSocket from \"../utils/duelSocket\";\nimport SimpleCodeEditor from \"../components/SimpleCodeEditor\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst DEFAULT_LANGUAGE = \"python\";\nconst difficultyMeta = {\n  Easy: {\n    label: \"Easy\",\n    className: \"badge-easy\"\n  },\n  Medium: {\n    label: \"Medium\",\n    className: \"badge-medium\"\n  },\n  Hard: {\n    label: \"Hard\",\n    className: \"badge-hard\"\n  }\n};\nfunction formatSeconds(total) {\n  const m = Math.floor(total / 60).toString().padStart(2, \"0\");\n  const s = (total % 60).toString().padStart(2, \"0\");\n  return `${m}:${s}`;\n}\nexport default function DuelRoomPage() {\n  _s();\n  var _players$find, _problem$exampleTests3;\n  const {\n    roomId\n  } = useParams();\n  const navigate = useNavigate();\n  const {\n    user\n  } = useAuth();\n  const socketRef = useRef(null);\n  const [isHost, setIsHost] = useState(false);\n  const [roomStatus, setRoomStatus] = useState(\"Waiting to start\");\n  const [players, setPlayers] = useState([]);\n  const [problem, setProblem] = useState(null);\n  const [language, setLanguage] = useState(DEFAULT_LANGUAGE);\n  const [code, setCode] = useState(\"\");\n  const [customInput, setCustomInput] = useState(\"\");\n  const [runOutput, setRunOutput] = useState(\"\");\n  const [statusMessage, setStatusMessage] = useState(\"\");\n  const [isRunningCode, setIsRunningCode] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [timerSeconds, setTimerSeconds] = useState(null);\n  const timerIntervalRef = useRef(null);\n  const [winner, setWinner] = useState(null);\n  const [allowSubmit, setAllowSubmit] = useState(false);\n\n  // ---------------------- socket init ----------------------\n  useEffect(() => {\n    const socket = duelSocket();\n    socketRef.current = socket;\n    socket.emit(\"duel_join_room\", {\n      roomId\n    });\n    socket.on(\"duel_room_state\", payload => {\n      setPlayers(payload.players || []);\n      setIsHost(payload.hostUserId === (user === null || user === void 0 ? void 0 : user._id));\n      if (payload.problem) {\n        setProblem(payload.problem);\n        setAllowSubmit(true);\n      }\n      if (typeof payload.remainingSeconds === \"number\") {\n        startTimerCountdown(payload.remainingSeconds);\n      }\n      if (payload.status) setRoomStatus(payload.status);\n      if (payload.winner) setWinner(payload.winner);\n    });\n    socket.on(\"duel_started\", ({\n      problem: p,\n      durationSeconds\n    }) => {\n      setProblem(p);\n      setAllowSubmit(true);\n      setRoomStatus(\"Duel in progress\");\n      startTimerCountdown(durationSeconds);\n    });\n    socket.on(\"duel_winner\", ({\n      winner\n    }) => {\n      setWinner(winner);\n      setRoomStatus(\"Finished\");\n      setAllowSubmit(false);\n      clearTimer();\n    });\n    socket.on(\"duel_error\", ({\n      message\n    }) => {\n      setStatusMessage(message || \"Something went wrong\");\n    });\n    return () => {\n      clearTimer();\n      socket.disconnect();\n    };\n  }, [roomId, user === null || user === void 0 ? void 0 : user._id]);\n\n  // ---------------------- timer helpers ----------------------\n  function clearTimer() {\n    if (timerIntervalRef.current) {\n      clearInterval(timerIntervalRef.current);\n      timerIntervalRef.current = null;\n    }\n  }\n  function startTimerCountdown(initial) {\n    clearTimer();\n    setTimerSeconds(initial);\n    timerIntervalRef.current = setInterval(() => {\n      setTimerSeconds(prev => {\n        if (prev === null) return prev;\n        if (prev <= 1) {\n          clearTimer();\n          return 0;\n        }\n        return prev - 1;\n      });\n    }, 1000);\n  }\n\n  // ---------------------- host: start duel ----------------------\n  async function handleStartDuel() {\n    if (!socketRef.current || !isHost) return;\n    try {\n      setStatusMessage(\"\");\n      socketRef.current.emit(\"duel_start\", {\n        roomId\n      });\n    } catch (err) {\n      console.error(err);\n      setStatusMessage(\"Failed to start duel\");\n    }\n  }\n\n  // ---------------------- Run Code (local) ----------------------\n  async function handleRunCode() {\n    if (!problem) return;\n    try {\n      var _problem$exampleTests, _problem$exampleTests2;\n      setIsRunningCode(true);\n      setRunOutput(\"\");\n      setStatusMessage(\"\");\n      const res = await api.post(\"/judge/run\", {\n        language,\n        source: code,\n        stdin: customInput || ((_problem$exampleTests = problem.exampleTests) === null || _problem$exampleTests === void 0 ? void 0 : (_problem$exampleTests2 = _problem$exampleTests[0]) === null || _problem$exampleTests2 === void 0 ? void 0 : _problem$exampleTests2.input) || \"\"\n      });\n      setRunOutput(res.data.stdout || res.data.stderr || \"\");\n    } catch (err) {\n      var _err$response, _err$response$data;\n      console.error(err);\n      setRunOutput(\"\");\n      setStatusMessage(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || \"Failed to run code. Please try again.\");\n    } finally {\n      setIsRunningCode(false);\n    }\n  }\n\n  // ---------------------- Submit to Duel ----------------------\n  async function handleSubmitToDuel() {\n    if (!problem || !allowSubmit || !socketRef.current) return;\n    try {\n      setIsSubmitting(true);\n      setStatusMessage(\"Submission received – waiting for evaluation…\");\n      socketRef.current.emit(\"duel_submit_code\", {\n        roomId,\n        problemId: problem._id,\n        language,\n        source: code\n      });\n    } catch (err) {\n      var _err$response2, _err$response2$data;\n      console.error(err);\n      setStatusMessage(((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.message) || \"Failed to submit. Please try again.\");\n    } finally {\n      setIsSubmitting(false);\n    }\n  }\n\n  // server notifies result of our own submission\n  useEffect(() => {\n    const socket = socketRef.current;\n    if (!socket) return;\n    function onSubmissionResult(payload) {\n      if (payload.passedAll) {\n        setStatusMessage(\"✅ Accepted! Waiting for server to confirm winner…\");\n      } else {\n        setStatusMessage(\"❌ Not accepted – some tests failed.\");\n      }\n      if (payload.stdout || payload.stderr) {\n        setRunOutput(payload.stdout || payload.stderr);\n      }\n    }\n    socket.on(\"duel_submission_result\", onSubmissionResult);\n    return () => {\n      socket.off(\"duel_submission_result\", onSubmissionResult);\n    };\n  }, [socketRef.current]);\n\n  // ---------------------- UI helpers ----------------------\n  const currentDifficultyMeta = problem && difficultyMeta[problem.difficulty] ? difficultyMeta[problem.difficulty] : difficultyMeta.Easy;\n\n  // ---------------------- render ----------------------\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"duel-room-page\",\n    children: [/*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"duel-room-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"duel-player-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"label\",\n          children: \"You\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"value\",\n          children: (user === null || user === void 0 ? void 0 : user.username) || \"—\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"status\",\n          children: [\"Status: \", isHost ? \"Host\" : \"Participant\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"duel-center-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"label\",\n          children: \"Duel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"value\",\n          children: winner ? `Winner: ${winner.username || winner}` : roomStatus || \"Waiting to start\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 11\n        }, this), timerSeconds !== null && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"timer\",\n          children: [\"Time left: \", formatSeconds(timerSeconds)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"duel-player-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"label\",\n          children: \"Opponent\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"value\",\n          children: ((_players$find = players.find(p => p.userId !== (user === null || user === void 0 ? void 0 : user._id))) === null || _players$find === void 0 ? void 0 : _players$find.username) || \"—\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"status\",\n          children: [\"Players: \", players.length]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"duel-room-main\",\n      children: [/*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"duel-problem-panel\",\n        children: !problem ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"empty-problem\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Waiting for problem\\u2026\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 247,\n            columnNumber: 15\n          }, this), isHost && /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"primary-button\",\n            onClick: handleStartDuel,\n            disabled: roomStatus === \"Duel in progress\",\n            children: \"Start Duel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 249,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"duel-problem-header\",\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              children: problem.title\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 261,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: `difficulty-badge ${currentDifficultyMeta.className}`,\n              children: currentDifficultyMeta.label\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 262,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 260,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"problem-description\",\n            children: problem.description\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 267,\n            columnNumber: 15\n          }, this), ((_problem$exampleTests3 = problem.exampleTests) === null || _problem$exampleTests3 === void 0 ? void 0 : _problem$exampleTests3.length) > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"problem-examples\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              children: \"Examples\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 271,\n              columnNumber: 19\n            }, this), problem.exampleTests.map((ex, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"example-card\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"example-title\",\n                children: [\"Example \", idx + 1]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 274,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"example-io\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"example-label\",\n                  children: \"Input:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 276,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"pre\", {\n                  className: \"example-code\",\n                  children: ex.input\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 277,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"example-label\",\n                  children: \"Output:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 278,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"pre\", {\n                  className: \"example-code\",\n                  children: ex.output\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 279,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 275,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"use-as-input-btn\",\n                onClick: () => setCustomInput(ex.input),\n                children: \"Use as Input\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 281,\n                columnNumber: 23\n              }, this)]\n            }, idx, true, {\n              fileName: _jsxFileName,\n              lineNumber: 273,\n              columnNumber: 21\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 270,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"duel-code-panel\",\n        children: [/*#__PURE__*/_jsxDEV(\"header\", {\n          className: \"duel-code-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"title\",\n            children: \"Your Code\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 298,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"code-toolbar\",\n            children: [/*#__PURE__*/_jsxDEV(\"select\", {\n              className: \"language-select\",\n              value: language,\n              onChange: e => setLanguage(e.target.value),\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"python\",\n                children: \"Python\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 306,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"cpp\",\n                children: \"C++\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 307,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"java\",\n                children: \"Java\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 308,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"javascript\",\n                children: \"JavaScript\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 309,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 301,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"secondary-button\",\n              onClick: handleRunCode,\n              disabled: isRunningCode || !problem,\n              children: isRunningCode ? \"Running…\" : \"Run Code\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 312,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"primary-button\",\n              onClick: handleSubmitToDuel,\n              disabled: isSubmitting || !allowSubmit || !problem,\n              children: isSubmitting ? \"Submitting…\" : \"Submit to Duel\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 320,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 300,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 297,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"editor-shell\",\n          children: /*#__PURE__*/_jsxDEV(SimpleCodeEditor, {\n            value: code,\n            language: language,\n            onChange: setCode,\n            readOnly: !problem || roomStatus === \"Finished\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 332,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 331,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"duel-output-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"output-panel\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"panel-title\",\n              children: \"OUTPUT\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 342,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"pre\", {\n              className: \"output-body\",\n              children: runOutput || \"Run code to see output…\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 343,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 341,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"stdin-panel\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"panel-title\",\n              children: \"Custom Input (stdin)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 349,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n              className: \"stdin-textarea\",\n              placeholder: \"Optional custom input\",\n              value: customInput,\n              onChange: e => setCustomInput(e.target.value)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 350,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 348,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 340,\n          columnNumber: 11\n        }, this), statusMessage && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"status-message\",\n          children: statusMessage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 360,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 296,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 211,\n    columnNumber: 5\n  }, this);\n}\n_s(DuelRoomPage, \"q1r1oQUmdlfvyCV9oaEN02i7YHw=\", false, function () {\n  return [useParams, useNavigate, useAuth];\n});\n_c = DuelRoomPage;\nvar _c;\n$RefreshReg$(_c, \"DuelRoomPage\");","map":{"version":3,"names":["React","useEffect","useState","useRef","useParams","useNavigate","useAuth","api","duelSocket","SimpleCodeEditor","jsxDEV","_jsxDEV","Fragment","_Fragment","DEFAULT_LANGUAGE","difficultyMeta","Easy","label","className","Medium","Hard","formatSeconds","total","m","Math","floor","toString","padStart","s","DuelRoomPage","_s","_players$find","_problem$exampleTests3","roomId","navigate","user","socketRef","isHost","setIsHost","roomStatus","setRoomStatus","players","setPlayers","problem","setProblem","language","setLanguage","code","setCode","customInput","setCustomInput","runOutput","setRunOutput","statusMessage","setStatusMessage","isRunningCode","setIsRunningCode","isSubmitting","setIsSubmitting","timerSeconds","setTimerSeconds","timerIntervalRef","winner","setWinner","allowSubmit","setAllowSubmit","socket","current","emit","on","payload","hostUserId","_id","remainingSeconds","startTimerCountdown","status","p","durationSeconds","clearTimer","message","disconnect","clearInterval","initial","setInterval","prev","handleStartDuel","err","console","error","handleRunCode","_problem$exampleTests","_problem$exampleTests2","res","post","source","stdin","exampleTests","input","data","stdout","stderr","_err$response","_err$response$data","response","handleSubmitToDuel","problemId","_err$response2","_err$response2$data","onSubmissionResult","passedAll","off","currentDifficultyMeta","difficulty","children","fileName","_jsxFileName","lineNumber","columnNumber","username","find","userId","length","onClick","disabled","title","description","map","ex","idx","output","value","onChange","e","target","readOnly","placeholder","_c","$RefreshReg$"],"sources":["C:/Users/abhig/OneDrive/Desktop/leetclone/client/src/pages/DuelRoomPage.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\r\nimport { useParams, useNavigate } from \"react-router-dom\";\r\nimport { useAuth } from \"../context/AuthContext\";\r\nimport api from \"../utils/api\";\r\nimport duelSocket from \"../utils/duelSocket\";\r\nimport SimpleCodeEditor from \"../components/SimpleCodeEditor\";\r\n\r\nconst DEFAULT_LANGUAGE = \"python\";\r\n\r\nconst difficultyMeta = {\r\n  Easy: { label: \"Easy\", className: \"badge-easy\" },\r\n  Medium: { label: \"Medium\", className: \"badge-medium\" },\r\n  Hard: { label: \"Hard\", className: \"badge-hard\" },\r\n};\r\n\r\nfunction formatSeconds(total) {\r\n  const m = Math.floor(total / 60)\r\n    .toString()\r\n    .padStart(2, \"0\");\r\n  const s = (total % 60).toString().padStart(2, \"0\");\r\n  return `${m}:${s}`;\r\n}\r\n\r\nexport default function DuelRoomPage() {\r\n  const { roomId } = useParams();\r\n  const navigate = useNavigate();\r\n  const { user } = useAuth();\r\n\r\n  const socketRef = useRef(null);\r\n\r\n  const [isHost, setIsHost] = useState(false);\r\n  const [roomStatus, setRoomStatus] = useState(\"Waiting to start\");\r\n  const [players, setPlayers] = useState([]);\r\n  const [problem, setProblem] = useState(null);\r\n\r\n  const [language, setLanguage] = useState(DEFAULT_LANGUAGE);\r\n  const [code, setCode] = useState(\"\");\r\n  const [customInput, setCustomInput] = useState(\"\");\r\n\r\n  const [runOutput, setRunOutput] = useState(\"\");\r\n  const [statusMessage, setStatusMessage] = useState(\"\");\r\n  const [isRunningCode, setIsRunningCode] = useState(false);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n\r\n  const [timerSeconds, setTimerSeconds] = useState(null);\r\n  const timerIntervalRef = useRef(null);\r\n\r\n  const [winner, setWinner] = useState(null);\r\n  const [allowSubmit, setAllowSubmit] = useState(false);\r\n\r\n  // ---------------------- socket init ----------------------\r\n  useEffect(() => {\r\n    const socket = duelSocket();\r\n    socketRef.current = socket;\r\n\r\n    socket.emit(\"duel_join_room\", { roomId });\r\n\r\n    socket.on(\"duel_room_state\", (payload) => {\r\n      setPlayers(payload.players || []);\r\n      setIsHost(payload.hostUserId === user?._id);\r\n      if (payload.problem) {\r\n        setProblem(payload.problem);\r\n        setAllowSubmit(true);\r\n      }\r\n      if (typeof payload.remainingSeconds === \"number\") {\r\n        startTimerCountdown(payload.remainingSeconds);\r\n      }\r\n      if (payload.status) setRoomStatus(payload.status);\r\n      if (payload.winner) setWinner(payload.winner);\r\n    });\r\n\r\n    socket.on(\"duel_started\", ({ problem: p, durationSeconds }) => {\r\n      setProblem(p);\r\n      setAllowSubmit(true);\r\n      setRoomStatus(\"Duel in progress\");\r\n      startTimerCountdown(durationSeconds);\r\n    });\r\n\r\n    socket.on(\"duel_winner\", ({ winner }) => {\r\n      setWinner(winner);\r\n      setRoomStatus(\"Finished\");\r\n      setAllowSubmit(false);\r\n      clearTimer();\r\n    });\r\n\r\n    socket.on(\"duel_error\", ({ message }) => {\r\n      setStatusMessage(message || \"Something went wrong\");\r\n    });\r\n\r\n    return () => {\r\n      clearTimer();\r\n      socket.disconnect();\r\n    };\r\n  }, [roomId, user?._id]);\r\n\r\n  // ---------------------- timer helpers ----------------------\r\n  function clearTimer() {\r\n    if (timerIntervalRef.current) {\r\n      clearInterval(timerIntervalRef.current);\r\n      timerIntervalRef.current = null;\r\n    }\r\n  }\r\n\r\n  function startTimerCountdown(initial) {\r\n    clearTimer();\r\n    setTimerSeconds(initial);\r\n    timerIntervalRef.current = setInterval(() => {\r\n      setTimerSeconds((prev) => {\r\n        if (prev === null) return prev;\r\n        if (prev <= 1) {\r\n          clearTimer();\r\n          return 0;\r\n        }\r\n        return prev - 1;\r\n      });\r\n    }, 1000);\r\n  }\r\n\r\n  // ---------------------- host: start duel ----------------------\r\n  async function handleStartDuel() {\r\n    if (!socketRef.current || !isHost) return;\r\n    try {\r\n      setStatusMessage(\"\");\r\n      socketRef.current.emit(\"duel_start\", { roomId });\r\n    } catch (err) {\r\n      console.error(err);\r\n      setStatusMessage(\"Failed to start duel\");\r\n    }\r\n  }\r\n\r\n  // ---------------------- Run Code (local) ----------------------\r\n  async function handleRunCode() {\r\n    if (!problem) return;\r\n    try {\r\n      setIsRunningCode(true);\r\n      setRunOutput(\"\");\r\n      setStatusMessage(\"\");\r\n\r\n      const res = await api.post(\"/judge/run\", {\r\n        language,\r\n        source: code,\r\n        stdin: customInput || problem.exampleTests?.[0]?.input || \"\",\r\n      });\r\n\r\n      setRunOutput(res.data.stdout || res.data.stderr || \"\");\r\n    } catch (err) {\r\n      console.error(err);\r\n      setRunOutput(\"\");\r\n      setStatusMessage(\r\n        err.response?.data?.message || \"Failed to run code. Please try again.\"\r\n      );\r\n    } finally {\r\n      setIsRunningCode(false);\r\n    }\r\n  }\r\n\r\n  // ---------------------- Submit to Duel ----------------------\r\n  async function handleSubmitToDuel() {\r\n    if (!problem || !allowSubmit || !socketRef.current) return;\r\n\r\n    try {\r\n      setIsSubmitting(true);\r\n      setStatusMessage(\"Submission received – waiting for evaluation…\");\r\n\r\n      socketRef.current.emit(\"duel_submit_code\", {\r\n        roomId,\r\n        problemId: problem._id,\r\n        language,\r\n        source: code,\r\n      });\r\n    } catch (err) {\r\n      console.error(err);\r\n      setStatusMessage(\r\n        err.response?.data?.message || \"Failed to submit. Please try again.\"\r\n      );\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  }\r\n\r\n  // server notifies result of our own submission\r\n  useEffect(() => {\r\n    const socket = socketRef.current;\r\n    if (!socket) return;\r\n\r\n    function onSubmissionResult(payload) {\r\n      if (payload.passedAll) {\r\n        setStatusMessage(\"✅ Accepted! Waiting for server to confirm winner…\");\r\n      } else {\r\n        setStatusMessage(\"❌ Not accepted – some tests failed.\");\r\n      }\r\n      if (payload.stdout || payload.stderr) {\r\n        setRunOutput(payload.stdout || payload.stderr);\r\n      }\r\n    }\r\n\r\n    socket.on(\"duel_submission_result\", onSubmissionResult);\r\n    return () => {\r\n      socket.off(\"duel_submission_result\", onSubmissionResult);\r\n    };\r\n  }, [socketRef.current]);\r\n\r\n  // ---------------------- UI helpers ----------------------\r\n  const currentDifficultyMeta =\r\n    problem && difficultyMeta[problem.difficulty]\r\n      ? difficultyMeta[problem.difficulty]\r\n      : difficultyMeta.Easy;\r\n\r\n  // ---------------------- render ----------------------\r\n  return (\r\n    <div className=\"duel-room-page\">\r\n      <header className=\"duel-room-header\">\r\n        <div className=\"duel-player-card\">\r\n          <div className=\"label\">You</div>\r\n          <div className=\"value\">{user?.username || \"—\"}</div>\r\n          <div className=\"status\">\r\n            Status: {isHost ? \"Host\" : \"Participant\"}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"duel-center-card\">\r\n          <div className=\"label\">Duel</div>\r\n          <div className=\"value\">\r\n            {winner\r\n              ? `Winner: ${winner.username || winner}`\r\n              : roomStatus || \"Waiting to start\"}\r\n          </div>\r\n          {timerSeconds !== null && (\r\n            <div className=\"timer\">Time left: {formatSeconds(timerSeconds)}</div>\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"duel-player-card\">\r\n          <div className=\"label\">Opponent</div>\r\n          <div className=\"value\">\r\n            {players.find((p) => p.userId !== user?._id)?.username || \"—\"}\r\n          </div>\r\n          <div className=\"status\">Players: {players.length}</div>\r\n        </div>\r\n      </header>\r\n\r\n      <main className=\"duel-room-main\">\r\n        {/* LEFT: problem */}\r\n        <section className=\"duel-problem-panel\">\r\n          {!problem ? (\r\n            <div className=\"empty-problem\">\r\n              <h2>Waiting for problem…</h2>\r\n              {isHost && (\r\n                <button\r\n                  className=\"primary-button\"\r\n                  onClick={handleStartDuel}\r\n                  disabled={roomStatus === \"Duel in progress\"}\r\n                >\r\n                  Start Duel\r\n                </button>\r\n              )}\r\n            </div>\r\n          ) : (\r\n            <>\r\n              <div className=\"duel-problem-header\">\r\n                <h2>{problem.title}</h2>\r\n                <span className={`difficulty-badge ${currentDifficultyMeta.className}`}>\r\n                  {currentDifficultyMeta.label}\r\n                </span>\r\n              </div>\r\n\r\n              <p className=\"problem-description\">{problem.description}</p>\r\n\r\n              {problem.exampleTests?.length > 0 && (\r\n                <div className=\"problem-examples\">\r\n                  <h3>Examples</h3>\r\n                  {problem.exampleTests.map((ex, idx) => (\r\n                    <div key={idx} className=\"example-card\">\r\n                      <div className=\"example-title\">Example {idx + 1}</div>\r\n                      <div className=\"example-io\">\r\n                        <div className=\"example-label\">Input:</div>\r\n                        <pre className=\"example-code\">{ex.input}</pre>\r\n                        <div className=\"example-label\">Output:</div>\r\n                        <pre className=\"example-code\">{ex.output}</pre>\r\n                      </div>\r\n                      <button\r\n                        className=\"use-as-input-btn\"\r\n                        onClick={() => setCustomInput(ex.input)}\r\n                      >\r\n                        Use as Input\r\n                      </button>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </>\r\n          )}\r\n        </section>\r\n\r\n        {/* RIGHT: code editor */}\r\n        <section className=\"duel-code-panel\">\r\n          <header className=\"duel-code-header\">\r\n            <div className=\"title\">Your Code</div>\r\n\r\n            <div className=\"code-toolbar\">\r\n              <select\r\n                className=\"language-select\"\r\n                value={language}\r\n                onChange={(e) => setLanguage(e.target.value)}\r\n              >\r\n                <option value=\"python\">Python</option>\r\n                <option value=\"cpp\">C++</option>\r\n                <option value=\"java\">Java</option>\r\n                <option value=\"javascript\">JavaScript</option>\r\n              </select>\r\n\r\n              <button\r\n                className=\"secondary-button\"\r\n                onClick={handleRunCode}\r\n                disabled={isRunningCode || !problem}\r\n              >\r\n                {isRunningCode ? \"Running…\" : \"Run Code\"}\r\n              </button>\r\n\r\n              <button\r\n                className=\"primary-button\"\r\n                onClick={handleSubmitToDuel}\r\n                disabled={isSubmitting || !allowSubmit || !problem}\r\n              >\r\n                {isSubmitting ? \"Submitting…\" : \"Submit to Duel\"}\r\n              </button>\r\n            </div>\r\n          </header>\r\n\r\n          {/* IMPORTANT: plain editor only – no built-in buttons/output */}\r\n          <div className=\"editor-shell\">\r\n            <SimpleCodeEditor\r\n              value={code}\r\n              language={language}\r\n              onChange={setCode}\r\n              readOnly={!problem || roomStatus === \"Finished\"}\r\n            />\r\n          </div>\r\n\r\n          <div className=\"duel-output-section\">\r\n            <div className=\"output-panel\">\r\n              <div className=\"panel-title\">OUTPUT</div>\r\n              <pre className=\"output-body\">\r\n                {runOutput || \"Run code to see output…\"}\r\n              </pre>\r\n            </div>\r\n\r\n            <div className=\"stdin-panel\">\r\n              <div className=\"panel-title\">Custom Input (stdin)</div>\r\n              <textarea\r\n                className=\"stdin-textarea\"\r\n                placeholder=\"Optional custom input\"\r\n                value={customInput}\r\n                onChange={(e) => setCustomInput(e.target.value)}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {statusMessage && (\r\n            <div className=\"status-message\">\r\n              {statusMessage}\r\n            </div>\r\n          )}\r\n        </section>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}